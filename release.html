<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‚òÖ New Mixtape ‚Ä¢ Happy Birthday! ‚òÖ</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html {
        overflow-x: hidden;
        -webkit-text-size-adjust: 100%;
        scroll-padding-top: 5rem;
        min-height: 100vh;
        min-height: 100dvh;
      }

      body {
        font-family: Georgia, "Times New Roman", serif;
        background-color: #fff0f5;
        background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffc0cb' fill-opacity='0.3'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        color: #333;
        min-height: 100vh;
        min-height: 100dvh;
        line-height: 1.6;
        overflow-x: hidden;
        display: flex;
        flex-direction: column;
      }

      header,
      .banner,
      main,
      footer {
        position: relative;
        z-index: 10;
      }

      header {
        position: sticky;
        top: 0;
        z-index: 100;
        background: linear-gradient(90deg, #ff69b4, #ff1493, #ff69b4);
        padding: 1rem;
        border-bottom: 4px dashed #fff;
        box-shadow: 0 4px 0 #333;
      }

      nav {
        display: flex;
        justify-content: center;
        gap: 2rem;
        flex-wrap: wrap;
      }

      nav a {
        color: #fff;
        text-decoration: none;
        font-weight: bold;
        font-size: 1.1rem;
        text-shadow: 2px 2px 0 #333;
        padding: 0.25rem 0.5rem;
      }

      nav a:hover {
        background: rgba(255, 255, 255, 0.3);
        border-radius: 4px;
      }

      .banner,
      section {
        scroll-margin-top: 5rem;
      }

      .banner {
        text-align: center;
        padding: 2rem;
        background: linear-gradient(
          180deg,
          #ffb6c1 0%,
          #ff69b4 50%,
          #ff1493 100%
        );
        border: 5px double #fff;
        margin: 1rem;
        animation: pulse 2s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.02);
        }
      }

      .banner h1 {
        font-family: "Comic Sans MS", "Marker Felt", cursive;
        font-size: clamp(2rem, 8vw, 4rem);
        color: #fff;
        text-shadow:
          3px 3px 0 #333,
          -1px -1px 0 #333;
        letter-spacing: 0.2em;
      }

      .banner .stars {
        font-size: 1.5rem;
        animation: blink 1s step-end infinite;
      }
      @keyframes blink {
        50% {
          opacity: 0;
        }
      }

      main {
        max-width: 720px;
        margin: 0 auto;
        padding: 2rem 1rem;
        flex: 1;
      }

      .release-section {
        background: #fff;
        border: 3px solid #ff69b4;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 5px 5px 0 #ffb6c1;
      }

      .release-section h2 {
        color: #ff1493;
        font-family: "Comic Sans MS", cursive;
        font-size: 1.5rem;
        margin-bottom: 1rem;
        border-bottom: 2px dotted #ff69b4;
        padding-bottom: 0.5rem;
      }

      /* Old-school Spotify / Winamp layout */
      .release-layout {
        display: flex;
        gap: 1.5rem;
        flex-wrap: wrap;
      }

      .album-cover-wrap {
        flex-shrink: 0;
        width: 240px;
        height: 240px;
        border: 4px solid #ff69b4;
        box-shadow: 4px 4px 0 #ffb6c1;
        background: linear-gradient(145deg, #ffe4ec 0%, #ffc0cb 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Comic Sans MS", cursive;
        color: #ff1493;
        font-size: 0.9rem;
        text-align: center;
        padding: 0.5rem;
      }

      .album-cover-wrap img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

      .track-list-wrap {
        flex: 1;
        min-width: 340px;
      }

      .track-list {
        border: 2px solid #ff69b4;
        background: #fff;
        list-style: none;
      }

      .track-list li {
        display: grid;
        grid-template-columns: 2rem 1fr 3rem;
        gap: 0.75rem;
        align-items: center;
        padding: 0.5rem 0.75rem;
        border-bottom: 1px dashed #ffb6c1;
        font-size: 0.95rem;
        cursor: pointer;
      }

      .track-list li:last-child {
        border-bottom: none;
      }

      .track-list li:hover {
        background: #fff0f5;
      }

      .track-list li.playing {
        background: #ffe4ec;
        color: #ff1493;
        font-weight: bold;
      }

      .track-num {
        font-family: "Courier New", monospace;
        color: #ff1493;
        font-weight: bold;
      }

      .track-duration {
        font-family: "Courier New", monospace;
        font-size: 0.85rem;
        color: #666;
      }

      /* Player bar - old school at bottom */
      .player-bar {
        margin-top: 1.25rem;
        background: linear-gradient(90deg, #ff1493, #ff69b4);
        border: 3px solid #ff69b4;
        border-radius: 8px;
        box-shadow: 4px 4px 0 #ffb6c1;
        padding: 0.75rem 1rem;
        display: flex;
        flex-direction: column;
        align-items: stretch;
        gap: 0.75rem;
      }

      .player-now-playing {
        font-family: "Comic Sans MS", cursive;
        color: #fff;
        text-shadow: 1px 1px 0 #333;
        font-size: 0.95rem;
      }

      .player-controls-row {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 1rem;
      }

      .player-controls {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .player-btn {
        width: 36px;
        height: 36px;
        border: 2px solid #fff;
        background: rgba(255, 255, 255, 0.2);
        color: #fff;
        font-size: 1.1rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
      }

      .player-btn:hover {
        background: rgba(255, 255, 255, 0.4);
      }

      .player-progress-wrap {
        flex: 1;
        min-width: 120px;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.25rem 0;
        cursor: pointer;
      }

      .player-time {
        font-family: "Courier New", monospace;
        font-size: 0.8rem;
        color: #fff;
        min-width: 2.5rem;
      }

      .player-progress {
        flex: 1;
        height: 12px;
        min-height: 12px;
        -webkit-appearance: none;
        appearance: none;
        background: rgba(255, 255, 255, 0.3);
        border: 1px solid #fff;
        cursor: pointer;
      }

      .player-progress::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 18px;
        height: 18px;
        background: #fff;
        border: 2px solid #333;
        cursor: pointer;
        border-radius: 2px;
      }

      .player-progress::-moz-range-thumb {
        width: 18px;
        height: 18px;
        background: #fff;
        border: 2px solid #333;
        cursor: pointer;
        border-radius: 2px;
      }

      .player-volume-wrap {
        display: flex;
        align-items: center;
        gap: 0.25rem;
      }

      .player-volume-wrap input {
        width: 70px;
        height: 6px;
        -webkit-appearance: none;
        appearance: none;
        background: rgba(255, 255, 255, 0.3);
        border: 1px solid #fff;
      }

      .player-volume-wrap input::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 12px;
        height: 12px;
        background: #fff;
        border: 1px solid #333;
        cursor: pointer;
      }

      footer {
        text-align: center;
        padding: 1.5rem;
        margin-top: 2rem;
        background: linear-gradient(90deg, #ff1493, #ff69b4);
        color: #fff;
        font-size: 0.9rem;
        border-top: 4px dashed #fff;
      }

      footer p {
        margin: 0.25rem 0;
      }
      .construction {
        font-size: 0.8rem;
        opacity: 0.9;
      }

      @media (max-width: 768px) {
        .release-layout {
          flex-direction: column;
          align-items: center;
        }
        .album-cover-wrap {
          width: 200px;
          height: 200px;
        }
        .player-bar {
          flex-direction: column;
          align-items: stretch;
        }
        .player-progress-wrap {
          order: 1;
        }
      }

      @media (max-width: 480px) {
        header {
          padding: 0.75rem;
        }
        nav {
          gap: 1rem;
        }
        nav a {
          font-size: 1rem;
          padding: 0.5rem 0.75rem;
          min-height: 44px;
          display: inline-flex;
          align-items: center;
        }
        .banner {
          margin: 0.5rem;
          padding: 1.25rem 1rem;
        }
        .banner h1 {
          letter-spacing: 0.05em;
        }
        main {
          padding: 1rem 0.75rem;
        }
        .track-list li {
          grid-template-columns: 2rem 1fr 2.5rem;
          font-size: 0.85rem;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <nav>
        <a href="index.html">‚òÖ Home</a>
        <a href="message.html">‚òÖ Message</a>
        <a href="wishes.html">‚òÖ Wishes</a>
        <a href="collage.html">‚òÖ Collage</a>
        <a href="timepass.html">‚òÖ Timepass</a>
        <a href="release.html">‚òÖ Release</a>
      </nav>
    </header>

    <div class="banner">
      <span class="stars">‚òÖ ‚úß ‚òÖ ‚úß ‚òÖ</span>
      <h1>üéÇ HAPPY BIRTHDAY! üéÇ</h1>
      <span class="stars">‚òÖ ‚úß ‚òÖ ‚úß ‚òÖ</span>
    </div>

    <main>
      <section class="release-section">
        <h2>üéµ Rupali Mixtape (Early access)</h2>
        <div class="release-layout">
          <div class="album-cover-wrap" id="albumCover">
            <img src="assets/cpver.png" alt="Mixtape cover" />
          </div>
          <div class="track-list-wrap">
            <ul class="track-list" id="trackList">
              <li
                data-src="assets/songs/Best thing I've ever known.wav"
                data-title="Best thing I've ever known"
              >
                <span class="track-num">1</span>
                <span class="track-title">Best thing I've ever known</span>
                <span class="track-duration">--:--</span>
              </li>
            </ul>
          </div>
        </div>
        <div class="player-bar">
          <div class="player-now-playing">
            <strong id="nowPlayingTitle">‚Äî</strong>
          </div>
          <div class="player-controls-row">
            <div class="player-controls">
              <button
                type="button"
                class="player-btn"
                id="btnPrev"
                title="Previous"
              >
                ‚èÆ
              </button>
              <button
                type="button"
                class="player-btn"
                id="btnPlay"
                title="Play"
              >
                ‚ñ∂
              </button>
              <button
                type="button"
                class="player-btn"
                id="btnNext"
                title="Next"
              >
                ‚è≠
              </button>
            </div>
            <div class="player-progress-wrap">
              <span class="player-time" id="timeCurrent">0:00</span>
              <input
                type="range"
                class="player-progress"
                id="progress"
                min="0"
                max="100"
                value="0"
              />
              <span class="player-time" id="timeTotal">0:00</span>
            </div>
            <div class="player-volume-wrap">
              <span style="color: #fff; font-size: 0.9rem">‚ô™</span>
              <input
                type="range"
                id="volume"
                min="0"
                max="100"
                value="80"
                title="Volume"
              />
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <p><strong>¬© 2025 ‚Ä¢ Happy Birthday Website</strong></p>
      <p class="construction">
        Best viewed with nostalgia ‚Ä¢ Last updated: February 2025
      </p>
      <p>‚òÖ Thank you for visiting! ‚òÖ</p>
    </footer>

    <audio id="audio" preload="auto"></audio>

    <script>
      (function () {
        var audio = document.getElementById("audio");
        var trackList = document.getElementById("trackList");
        var tracks = Array.from(trackList.querySelectorAll("li"));
        var nowPlayingTitle = document.getElementById("nowPlayingTitle");
        var timeCurrent = document.getElementById("timeCurrent");
        var timeTotal = document.getElementById("timeTotal");
        var progress = document.getElementById("progress");
        var volume = document.getElementById("volume");
        var btnPlay = document.getElementById("btnPlay");
        var btnPrev = document.getElementById("btnPrev");
        var btnNext = document.getElementById("btnNext");

        var currentIndex = 0;
        var seekTarget = null;     // percentage the user seeked to; held until audio.seeked fires
        var pendingSeekPct = null; // seek requested before metadata was ready

        function formatTime(s) {
          if (!s || isNaN(s)) return "0:00";
          var m = Math.floor(s / 60);
          var sec = Math.floor(s % 60);
          return m + ":" + (sec < 10 ? "0" : "") + sec;
        }

        function loadTrack(index) {
          currentIndex = index;
          var track = tracks[index];
          if (!track) return;
          var src = track.getAttribute("data-src");
          var title =
            track.getAttribute("data-title") ||
            track.querySelector(".track-title").textContent;
          tracks.forEach(function (t) {
            t.classList.remove("playing");
          });
          track.classList.add("playing");
          nowPlayingTitle.textContent = title;
          timeTotal.textContent = "0:00";
          progress.value = 0;
          seekTarget = null;
          pendingSeekPct = null;
          if (src) {
            audio.src = encodeURI(src);
            audio.load();
            audio.play().catch(function () {});
            btnPlay.textContent = "‚ùö‚ùö";
          } else {
            audio.src = "";
            nowPlayingTitle.textContent = title + " (add audio file)";
          }
        }

        function updateTime() {
          var cur = audio.currentTime;
          var dur = audio.duration;
          if (dur && isFinite(dur)) {
            timeTotal.textContent = formatTime(dur);
            if (seekTarget !== null) {
              // While audio hasn't finished seeking, show user's intended position
              progress.value = seekTarget;
              timeCurrent.textContent = formatTime((seekTarget / 100) * dur);
            } else {
              progress.value = (cur / dur) * 100;
              timeCurrent.textContent = formatTime(cur);
            }
          } else {
            timeCurrent.textContent = formatTime(cur);
          }
        }

        // Clear seekTarget once the audio has arrived at the new position;
        // let the next timeupdate naturally sync the display
        audio.addEventListener("seeked", function () {
          seekTarget = null;
        });

        audio.addEventListener("loadedmetadata", function () {
          timeTotal.textContent = formatTime(audio.duration);
          if (pendingSeekPct !== null) {
            audio.currentTime = (pendingSeekPct / 100) * audio.duration;
            seekTarget = pendingSeekPct;
            pendingSeekPct = null;
          }
        });
        audio.addEventListener("timeupdate", updateTime);
        audio.addEventListener("ended", function () {
          if (currentIndex < tracks.length - 1) {
            loadTrack(currentIndex + 1);
          } else {
            btnPlay.textContent = "‚ñ∂";
            progress.value = 0;
            timeCurrent.textContent = "0:00";
          }
        });

        progress.addEventListener("input", function () {
          var pct = parseFloat(progress.value);
          var dur = audio.duration;
          if (dur && isFinite(dur)) {
            seekTarget = pct;
            audio.currentTime = (pct / 100) * dur;
            timeCurrent.textContent = formatTime((pct / 100) * dur);
          } else {
            // Metadata not ready yet ‚Äì queue the seek
            pendingSeekPct = pct;
            timeCurrent.textContent = "‚Ä¶";
          }
        });
        progress.addEventListener("change", function () {
          var pct = parseFloat(progress.value);
          var dur = audio.duration;
          if (dur && isFinite(dur)) {
            seekTarget = pct;
            audio.currentTime = (pct / 100) * dur;
          } else {
            pendingSeekPct = pct;
          }
        });

        volume.addEventListener("input", function () {
          audio.volume = volume.value / 100;
        });
        audio.volume = volume.value / 100;

        btnPlay.addEventListener("click", function () {
          if (audio.paused) {
            if (!audio.src && tracks.length) loadTrack(0);
            else audio.play();
            btnPlay.textContent = "‚ùö‚ùö";
          } else {
            audio.pause();
            btnPlay.textContent = "‚ñ∂";
          }
        });

        btnPrev.addEventListener("click", function () {
          if (audio.currentTime > 2) {
            audio.currentTime = 0;
          } else if (currentIndex > 0) {
            loadTrack(currentIndex - 1);
          }
        });

        btnNext.addEventListener("click", function () {
          if (currentIndex < tracks.length - 1) {
            loadTrack(currentIndex + 1);
          } else {
            audio.pause();
            audio.currentTime = 0;
            btnPlay.textContent = "‚ñ∂";
            progress.value = 0;
            timeCurrent.textContent = "0:00";
          }
        });

        tracks.forEach(function (track, i) {
          track.addEventListener("click", function () {
            loadTrack(i);
          });
        });
      })();
    </script>
  </body>
</html>
